---
chapter: "sqlI"
author: ""
difficulty: "Medium"
date: 2020-07-20 
version: 0.1
tags: [first, second, third]
id: cow-drink-pan
---

```{r cow-drink-pan-default, include = FALSE}
library(tidyverse)
mdsr2exercises::setup()
```

TITLE GOES HERE:  Use the `dbConnect_scidb` function to connect to the `airlines` database to answer the following problem.
Which airport had the highest average arrival delay time in 2010? 

<!--begin-answer-->
 
  
```{r, warning = FALSE, message= FALSE}
library(RMySQL)
con <- mdsr::dbConnect_scidb(dbname = "airlines")

myquery <- "
SELECT 
  dest, 
  sum(1) as numFlights,
  avg(arr_delay) as avg_arr_delay
FROM flights o
WHERE year = 2010
GROUP BY dest
ORDER BY avg_arr_delay desc
LIMIT 0,6;"

dbGetQuery(con, myquery)
```  

<!--end-answer-->
